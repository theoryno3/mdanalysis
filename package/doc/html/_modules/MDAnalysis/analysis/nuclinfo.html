

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MDAnalysis.analysis.nuclinfo &mdash; MDAnalysis 0.10.0-dev documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.10.0-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.10.0-dev documentation"
          href="../../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.10.0-dev documentation" href="../../../index.html" />
    <link rel="up" title="MDAnalysis" href="../../MDAnalysis.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">MDAnalysis 0.10.0-dev documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../MDAnalysis.html" accesskey="U">MDAnalysis</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for MDAnalysis.analysis.nuclinfo</h1><div class="highlight"><pre>
<span class="c"># -*- Mode: python; tab-width: 4; indent-tabs-mode:nil; coding:utf-8 -*-</span>
<span class="c"># vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4 fileencoding=utf-8</span>
<span class="c">#</span>
<span class="c"># MDAnalysis --- http://www.MDAnalysis.org</span>
<span class="c"># Copyright (c) 2006-2015 Naveen Michaud-Agrawal, Elizabeth J. Denning, Oliver Beckstein</span>
<span class="c"># and contributors (see AUTHORS for the full list)</span>
<span class="c">#</span>
<span class="c"># Released under the GNU Public Licence, v2 or any higher version</span>
<span class="c">#</span>
<span class="c"># Please cite your use of MDAnalysis in published work:</span>
<span class="c">#</span>
<span class="c"># N. Michaud-Agrawal, E. J. Denning, T. B. Woolf, and O. Beckstein.</span>
<span class="c"># MDAnalysis: A Toolkit for the Analysis of Molecular Dynamics Simulations.</span>
<span class="c"># J. Comput. Chem. 32 (2011), 2319--2327, doi:10.1002/jcc.21787</span>
<span class="c">#</span>

<span class="c"># MDAnalysis -- nucleic acid analysis</span>
<span class="c"># Copyright (c) 2011 Elizabeth Denning &lt;denniej0@gmail.com&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Nucleic acid analysis --- :mod:`MDAnalysis.analysis.nuclinfo`</span>
<span class="sd">=============================================================</span>

<span class="sd">:Author: Elizabeth Denning</span>
<span class="sd">:Year: 2011</span>
<span class="sd">:Copyright: GNU Public License v3</span>

<span class="sd">The module provides functions to analyze nuclic acid structures, in</span>
<span class="sd">particular </span>

<span class="sd">- backbone dihedrals, </span>
<span class="sd">- chi dihedrals, </span>
<span class="sd">- AS or CP phase angles,</span>
<span class="sd">- Watson-Crick N1-N3 distances, C2-O2 distances, N6-O4 distances, O6-N4 distances.</span>

<span class="sd">For applications of this kind of analysis see [Denning2011]_ and [Denning2012]_.</span>

<span class="sd">All functions take a :class:`~MDAnalysis.core.AtomGroup.Universe` as an argument</span>
<span class="sd">together with further parameters that specify the base or bases in question. Angles are </span>
<span class="sd">in degrees. The functions use standard CHARMM names for nucleic acids and atom names.</span>


<span class="sd">.. rubric:: References</span>

<span class="sd">.. [Denning2011] E.J. Denning, U.D. Priyakumar, L. Nilsson, and A.D. Mackerell, Jr. Impact of</span>
<span class="sd">              2&#39;-hydroxyl sampling on the conformational properties of RNA: update of the</span>
<span class="sd">              CHARMM all-atom additive force field for RNA. *J. Comput. Chem.* 32 (2011),</span>
<span class="sd">              1929--1943. doi: `10.1002/jcc.21777`_</span>

<span class="sd">.. [Denning2012] E.J. Denning and A.D. MacKerell, Jr. Intrinsic Contribution of the 2&#39;-Hydroxyl to </span>
<span class="sd">              RNA Conformational Heterogeneity. *J. Am. Chem. Soc.* 134 (2012), 2800--2806.</span>
<span class="sd">              doi: `10.1021/ja211328g`_</span>


<span class="sd">.. _`10.1002/jcc.21777`: http://dx.doi.org/10.1002/jcc.21777</span>
<span class="sd">.. _`10.1021/ja211328g`: http://dx.doi.org/10.1021/ja211328g</span>


<span class="sd">Distances</span>
<span class="sd">---------</span>

<span class="sd">.. autofunction:: wc_pair</span>

<span class="sd">.. autofunction:: minor_pair</span>

<span class="sd">.. autofunction:: major_pair</span>


<span class="sd">Phases</span>
<span class="sd">------</span>

<span class="sd">.. autofunction:: phase_cp</span>

<span class="sd">.. autofunction:: phase_as</span>


<span class="sd">Dihedral angles</span>
<span class="sd">---------------</span>

<span class="sd">.. autofunction:: tors</span>

<span class="sd">.. autofunction:: tors_alpha</span>

<span class="sd">.. autofunction:: tors_beta</span>

<span class="sd">.. autofunction:: tors_gamma</span>

<span class="sd">.. autofunction:: tors_delta</span>

<span class="sd">.. autofunction:: tors_eps</span>

<span class="sd">.. autofunction:: tors_zeta</span>

<span class="sd">.. autofunction:: tors_chi</span>

<span class="sd">.. autofunction:: hydroxyl</span>

<span class="sd">.. autofunction:: pseudo_dihe_baseflip</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">MDAnalysis.core.util</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">atan2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="nb">pow</span>


<div class="viewcode-block" id="wc_pair"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.wc_pair">[docs]</a><span class="k">def</span> <span class="nf">wc_pair</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">seg1</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">,</span> <span class="n">seg2</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Watson-Crick basepair distance for residue *i* with residue *bp*.</span>

<span class="sd">    The distance of the nitrogen atoms in a Watson-Crick hydrogen bond is</span>
<span class="sd">    computed.</span>

<span class="sd">    :Arguments:</span>
<span class="sd">      *universe*</span>
<span class="sd">          :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *seg1*</span>
<span class="sd">          segment id for first base</span>
<span class="sd">      *i*</span>
<span class="sd">          resid of the first base</span>
<span class="sd">      *seg2*</span>
<span class="sd">          segment id for second base</span>
<span class="sd">      *bp*</span>
<span class="sd">          resid of the second base</span>

<span class="sd">    NOTE: if failure occurs be sure to check the segment identification</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; resid </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span><span class="o">.</span><span class="n">resnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;DC&quot;</span><span class="p">,</span> <span class="s">&quot;DT&quot;</span><span class="p">,</span> <span class="s">&quot;U&quot;</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="s">&quot;T&quot;</span><span class="p">,</span> <span class="s">&quot;CYT&quot;</span><span class="p">,</span> <span class="s">&quot;THY&quot;</span><span class="p">,</span> <span class="s">&quot;URA&quot;</span><span class="p">]:</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="s">&quot;N3&quot;</span><span class="p">,</span> <span class="s">&quot;N1&quot;</span>
    <span class="k">if</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; resid </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span><span class="o">.</span><span class="n">resnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;DG&quot;</span><span class="p">,</span> <span class="s">&quot;DA&quot;</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="s">&quot;G&quot;</span><span class="p">,</span> <span class="s">&quot;ADE&quot;</span><span class="p">,</span> <span class="s">&quot;GUA&quot;</span><span class="p">]:</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="s">&quot;N1&quot;</span><span class="p">,</span> <span class="s">&quot;N3&quot;</span>
    <span class="n">wc_dist</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span>
        <span class="s">&quot; (segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and name </span><span class="si">%s</span><span class="s">)  or (segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and name </span><span class="si">%s</span><span class="s">) &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">seg2</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span>
    <span class="n">wc</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">wc_dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">wc_dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wc</span>

</div>
<div class="viewcode-block" id="minor_pair"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.minor_pair">[docs]</a><span class="k">def</span> <span class="nf">minor_pair</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">seg1</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">,</span> <span class="n">seg2</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Minor-Groove basepair distance for residue *i* with residue *bp*.</span>

<span class="sd">    The distance of the nitrogen and oxygen atoms in a Minor-groove hydrogen bond is</span>
<span class="sd">    computed.</span>

<span class="sd">    :Arguments:</span>
<span class="sd">      *universe*</span>
<span class="sd">          :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *seg1*</span>
<span class="sd">          segment id for first base</span>
<span class="sd">      *i*</span>
<span class="sd">          resid of the first base</span>
<span class="sd">      *seg2*</span>
<span class="sd">          segment id for second base</span>
<span class="sd">      *bp*</span>
<span class="sd">          resid of the second base</span>

<span class="sd">    NOTE: if failure occurs be sure to check the segment identification</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; resid </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span><span class="o">.</span><span class="n">resnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;DC&quot;</span><span class="p">,</span> <span class="s">&quot;DT&quot;</span><span class="p">,</span> <span class="s">&quot;U&quot;</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="s">&quot;T&quot;</span><span class="p">,</span> <span class="s">&quot;CYT&quot;</span><span class="p">,</span> <span class="s">&quot;THY&quot;</span><span class="p">,</span> <span class="s">&quot;URA&quot;</span><span class="p">]:</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="s">&quot;O2&quot;</span><span class="p">,</span> <span class="s">&quot;C2&quot;</span>
    <span class="k">if</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; resid </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span><span class="o">.</span><span class="n">resnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;DG&quot;</span><span class="p">,</span> <span class="s">&quot;DA&quot;</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="s">&quot;G&quot;</span><span class="p">,</span> <span class="s">&quot;ADE&quot;</span><span class="p">,</span> <span class="s">&quot;GUA&quot;</span><span class="p">]:</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="s">&quot;C2&quot;</span><span class="p">,</span> <span class="s">&quot;O2&quot;</span>
    <span class="n">c2o2_dist</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span>
        <span class="s">&quot; (segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and name </span><span class="si">%s</span><span class="s">)  or (segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and name </span><span class="si">%s</span><span class="s">) &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">seg2</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span>
    <span class="n">c2o2</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">c2o2_dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">c2o2_dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c2o2</span>

</div>
<div class="viewcode-block" id="major_pair"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.major_pair">[docs]</a><span class="k">def</span> <span class="nf">major_pair</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">seg1</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">,</span> <span class="n">seg2</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Major-Groove basepair distance for residue *i* with residue *bp*.</span>

<span class="sd">    The distance of the nitrogen and oxygen atoms in a Major-groove hydrogen bond is</span>
<span class="sd">    computed.</span>

<span class="sd">    :Arguments:</span>
<span class="sd">      *universe*</span>
<span class="sd">          :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory       *i*</span>
<span class="sd">      *seg1*</span>
<span class="sd">          segment id for first base</span>
<span class="sd">      *i*</span>
<span class="sd">          resid of the first base</span>
<span class="sd">      *seg2*</span>
<span class="sd">          segment id for second base</span>
<span class="sd">      *bp*</span>
<span class="sd">          resid of the second base</span>

<span class="sd">    NOTE: if failure occurs be sure to check the segment identification</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; resid </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span><span class="o">.</span><span class="n">resnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;DC&quot;</span><span class="p">,</span> <span class="s">&quot;DG&quot;</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="s">&quot;G&quot;</span><span class="p">,</span> <span class="s">&quot;CYT&quot;</span><span class="p">,</span> <span class="s">&quot;GUA&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; resid </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span><span class="o">.</span><span class="n">resnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;DC&quot;</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="s">&quot;CYT&quot;</span><span class="p">]:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="s">&quot;N4&quot;</span><span class="p">,</span> <span class="s">&quot;O6&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="s">&quot;O6&quot;</span><span class="p">,</span> <span class="s">&quot;N4&quot;</span>
    <span class="k">if</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; resid </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span><span class="o">.</span><span class="n">resnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;DT&quot;</span><span class="p">,</span> <span class="s">&quot;DA&quot;</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="s">&quot;T&quot;</span><span class="p">,</span> <span class="s">&quot;U&quot;</span><span class="p">,</span> <span class="s">&quot;ADE&quot;</span><span class="p">,</span> <span class="s">&quot;THY&quot;</span><span class="p">,</span> <span class="s">&quot;URA&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; resid </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span><span class="o">.</span><span class="n">resnames</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;DT&quot;</span><span class="p">,</span> <span class="s">&quot;T&quot;</span><span class="p">,</span> <span class="s">&quot;THY&quot;</span><span class="p">,</span> <span class="s">&quot;U&quot;</span><span class="p">,</span> <span class="s">&quot;URA&quot;</span><span class="p">]:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="s">&quot;O4&quot;</span><span class="p">,</span> <span class="s">&quot;N6&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="s">&quot;N6&quot;</span><span class="p">,</span> <span class="s">&quot;O4&quot;</span>
    <span class="n">no_dist</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span>
        <span class="s">&quot; (segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and name </span><span class="si">%s</span><span class="s">)  or (segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and name </span><span class="si">%s</span><span class="s">) &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">seg2</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span>
    <span class="n">major</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">no_dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">no_dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">major</span>

</div>
<div class="viewcode-block" id="phase_cp"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.phase_cp">[docs]</a><span class="k">def</span> <span class="nf">phase_cp</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pseudo-angle describing the phase of the ribose pucker for residue *i* </span>
<span class="sd">    using the CP method </span>
<span class="sd">    </span>
<span class="sd">    The angle is computed by the positions of atoms in the ribose ring </span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe* </span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">         </span>
<span class="sd">       *segid*</span>
<span class="sd">         segment identity of resid</span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>
<span class="sd">    </span>
<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atom1</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">atom2</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">atom3</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C2</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">atom4</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">atom5</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

    <span class="n">data1</span> <span class="o">=</span> <span class="n">atom1</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
    <span class="n">data2</span> <span class="o">=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
    <span class="n">data3</span> <span class="o">=</span> <span class="n">atom3</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
    <span class="n">data4</span> <span class="o">=</span> <span class="n">atom4</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
    <span class="n">data5</span> <span class="o">=</span> <span class="n">atom5</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>

    <span class="n">r0</span> <span class="o">=</span> <span class="p">(</span><span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span> <span class="o">+</span> <span class="n">data3</span> <span class="o">+</span> <span class="n">data4</span> <span class="o">+</span> <span class="n">data5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">data1</span> <span class="o">-</span> <span class="n">r0</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">data2</span> <span class="o">-</span> <span class="n">r0</span>
    <span class="n">r3</span> <span class="o">=</span> <span class="n">data3</span> <span class="o">-</span> <span class="n">r0</span>
    <span class="n">r4</span> <span class="o">=</span> <span class="n">data4</span> <span class="o">-</span> <span class="n">r0</span>
    <span class="n">r5</span> <span class="o">=</span> <span class="n">data5</span> <span class="o">-</span> <span class="n">r0</span>

    <span class="n">R1</span> <span class="o">=</span> <span class="p">((</span><span class="n">r1</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">0.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span>
          <span class="p">(</span><span class="n">r3</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r4</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r5</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)))</span>

    <span class="n">R2</span> <span class="o">=</span> <span class="p">((</span><span class="n">r1</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">0.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r2</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span>
          <span class="p">(</span><span class="n">r3</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r4</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r5</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">R1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">R2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>

    <span class="n">r1_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">r2_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">r3_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">r4_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">r5_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="n">D</span> <span class="o">=</span> <span class="p">((</span><span class="n">r1_d</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">0.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r2_d</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span>
         <span class="p">(</span><span class="n">r3_d</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r4_d</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r5_d</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)))</span> \
        <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="p">((</span><span class="n">r1_d</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">0.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r2_d</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r3_d</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span>
         <span class="p">(</span><span class="n">r4_d</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">r5_d</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)))</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span>

    <span class="n">phase_ang</span> <span class="o">=</span> <span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">))</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">pi</span>
    <span class="k">if</span> <span class="n">phase_ang</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">phase_ang</span> <span class="o">=</span> <span class="n">phase_ang</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">phase_ang</span>
    <span class="k">return</span> <span class="n">phase_ang</span>

</div>
<div class="viewcode-block" id="phase_as"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.phase_as">[docs]</a><span class="k">def</span> <span class="nf">phase_as</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pseudo-angle describing the phase of the ribose pucker for residue *i* using the AS method</span>
<span class="sd">    </span>
<span class="sd">    The angle is computed by the position vector of atoms in the ribose ring</span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe* </span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *segid*</span>
<span class="sd">         segment identity of resid</span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle1</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C2</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                  <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">angle2</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C2</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                  <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">angle3</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                  <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">angle4</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                  <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C2</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">angle5</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                  <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C2</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

    <span class="n">data1</span> <span class="o">=</span> <span class="n">angle1</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">data2</span> <span class="o">=</span> <span class="n">angle2</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">data3</span> <span class="o">=</span> <span class="n">angle3</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">data4</span> <span class="o">=</span> <span class="n">angle4</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">data5</span> <span class="o">=</span> <span class="n">angle5</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>

    <span class="n">B</span> <span class="o">=</span> <span class="p">((</span><span class="n">data1</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">data2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">))</span> <span class="o">+</span>
         <span class="p">(</span><span class="n">data3</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">data4</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">))</span> <span class="o">+</span>
         <span class="p">(</span><span class="n">data5</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">)))</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2.</span> <span class="o">/</span> <span class="mf">5.</span>

    <span class="n">A</span> <span class="o">=</span> <span class="p">((</span><span class="n">data1</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">data2</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">))</span> <span class="o">+</span>
         <span class="p">(</span><span class="n">data3</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">data4</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">))</span> <span class="o">+</span>
         <span class="p">(</span><span class="n">data5</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">)))</span> <span class="o">*</span> <span class="mf">2.</span> <span class="o">/</span> <span class="mf">5.</span>

    <span class="n">phase_ang</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">pi</span>
    <span class="k">if</span> <span class="n">phase_ang</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">phase_ang</span> <span class="o">=</span> <span class="n">phase_ang</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">phase_ang</span>
    <span class="k">return</span> <span class="n">phase_ang</span>

</div>
<div class="viewcode-block" id="tors"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.tors">[docs]</a><span class="k">def</span> <span class="nf">tors</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Backbone dihedrals includes alpha, beta, gamma, delta, epsilon, zeta, chi</span>
<span class="sd">    </span>
<span class="sd">    The dihedral is computed based on position atoms for resid *i* </span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe* </span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *segid*</span>
<span class="sd">         segid of resid </span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>

<span class="sd">    NOTE: if failure occurs be sure to check the segment identification</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> P  &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> P    &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> P    &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> P    &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                 <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> N1 &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C2  &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                 <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> N9 &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4  &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">zeta</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="n">chi</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">if</span> <span class="n">beta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">if</span> <span class="n">gamma</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">if</span> <span class="n">epsilon</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">if</span> <span class="n">zeta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">zeta</span> <span class="o">=</span> <span class="n">zeta</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">if</span> <span class="n">chi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">chi</span> <span class="o">=</span> <span class="n">chi</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">chi</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="tors_alpha"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.tors_alpha">[docs]</a><span class="k">def</span> <span class="nf">tors_alpha</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;alpha backbone dihedral</span>
<span class="sd">    </span>
<span class="sd">    The dihedral is computed based on position atoms for resid *i*</span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe*</span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *segid*</span>
<span class="sd">         segid of resid</span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> P  &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">alpha</span>

</div>
<div class="viewcode-block" id="tors_beta"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.tors_beta">[docs]</a><span class="k">def</span> <span class="nf">tors_beta</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;beta  backbone dihedral</span>
<span class="sd">    </span>
<span class="sd">    The dihedral is computed based on position atoms for resid *i*</span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe* </span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *segid*</span>
<span class="sd">         segid of resid</span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> P    &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">beta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">beta</span>

</div>
<div class="viewcode-block" id="tors_gamma"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.tors_gamma">[docs]</a><span class="k">def</span> <span class="nf">tors_gamma</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Gamma backbone dihedral</span>
<span class="sd">    </span>
<span class="sd">     The dihedral is computed based on position atoms for resid *i*</span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe* </span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *segid*</span>
<span class="sd">         segid of resid</span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">gamma</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">gamma</span>

</div>
<div class="viewcode-block" id="tors_delta"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.tors_delta">[docs]</a><span class="k">def</span> <span class="nf">tors_delta</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;delta backbone dihedral</span>
<span class="sd">    </span>
<span class="sd">    The dihedral is computed based on position atoms for resid *i*</span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe* </span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *segid*</span>
<span class="sd">         segid of resid</span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">delta</span>

</div>
<div class="viewcode-block" id="tors_eps"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.tors_eps">[docs]</a><span class="k">def</span> <span class="nf">tors_eps</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Epsilon backbone dihedral</span>

<span class="sd">    The dihedral is computed based on position atoms for resid *i*</span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe* </span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *segid*</span>
<span class="sd">         segid of resid</span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> P    &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">epsilon</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">epsilon</span>

</div>
<div class="viewcode-block" id="tors_zeta"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.tors_zeta">[docs]</a><span class="k">def</span> <span class="nf">tors_zeta</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Zeta backbone dihedral</span>

<span class="sd">    The dihedral is computed based on position atoms for resid *i*</span>
<span class="sd">    </span>
<span class="sd">    :Arguments:</span>
<span class="sd">      *universe* </span>
<span class="sd">         :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">      *segid*</span>
<span class="sd">         segid of resid</span>
<span class="sd">      *i*</span>
<span class="sd">         resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O3</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> P    &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O5</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">zeta</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">zeta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">zeta</span> <span class="o">=</span> <span class="n">zeta</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">zeta</span>

</div>
<div class="viewcode-block" id="tors_chi"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.tors_chi">[docs]</a><span class="k">def</span> <span class="nf">tors_chi</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;chi nucleic acid dihedral</span>
<span class="sd">     The dihedral is computed based on position atoms for resid *i*</span>
<span class="sd">     </span>
<span class="sd">     :Arguments:</span>
<span class="sd">       *universe* </span>
<span class="sd">           :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">       *segid*</span>
<span class="sd">           segid of resid</span>
<span class="sd">       *i*</span>
<span class="sd">           resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                 <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> N1 &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C2  &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O4</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                                 <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> N9 &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C4  &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">chi</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">chi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">chi</span> <span class="o">=</span> <span class="n">chi</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">chi</span>

</div>
<div class="viewcode-block" id="hydroxyl"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.hydroxyl">[docs]</a><span class="k">def</span> <span class="nf">hydroxyl</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;2-hydroxyl dihedral. Useful only for RNA calculations. </span>

<span class="sd">     :Note: This dihedral calculation will only work if using atom names </span>
<span class="sd">      as documented by charmm force field parameters. </span>

<span class="sd">     :Arguments:</span>
<span class="sd">       *universe* </span>
<span class="sd">           :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">       *segid*</span>
<span class="sd">           segid of resid</span>
<span class="sd">       *i*</span>
<span class="sd">           resid of the base</span>

<span class="sd">    .. versionadded:: 0.7.6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C1</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> C2</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                             <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> O2</span><span class="se">\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot; atom </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> H2</span><span class="se">\&#39;\&#39;</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">hydr</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">dihedral</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">hydr</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">hydr</span> <span class="o">=</span> <span class="n">hydr</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">hydr</span>

</div>
<div class="viewcode-block" id="pseudo_dihe_baseflip"><a class="viewcode-back" href="../../../documentation_pages/analysis/nuclinfo.html#MDAnalysis.analysis.nuclinfo.pseudo_dihe_baseflip">[docs]</a><span class="k">def</span> <span class="nf">pseudo_dihe_baseflip</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">bp1</span><span class="p">,</span> <span class="n">bp2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">seg1</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">,</span> <span class="n">seg2</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">,</span> <span class="n">seg3</span><span class="o">=</span><span class="s">&quot;SYSTEM&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;pseudo dihedral for flipped bases. Useful only for nucleic acid base flipping</span>
<span class="sd">     </span>
<span class="sd">     The dihedral is computed based on position atoms for resid *i*</span>
<span class="sd">    </span>
<span class="sd">     :Note: This dihedral calculation will only work if using atom names as documented by charmm force field parameters. </span>

<span class="sd">     :Arguments:</span>
<span class="sd">       *universe* </span>
<span class="sd">           :class:`~MDAnalysis.core.AtomGroup.Universe` containing the trajectory</span>
<span class="sd">       *segid1*</span>
<span class="sd">           segid of resid base pairing with bp2</span>
<span class="sd">       *bp1*</span>
<span class="sd">           resid that base pairs with bp2 </span>
<span class="sd">       *segid2*</span>
<span class="sd">           segid same as that of segid of flipping resid </span>
<span class="sd">       *bp2*</span>
<span class="sd">           resid below the base that flips </span>
<span class="sd">       *segid3*</span>
<span class="sd">           segid of resid that flips </span>
<span class="sd">       *i*</span>
<span class="sd">           resid of the base that flips</span>

<span class="sd">    .. versionadded:: 0.8.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">MDAnalysis.core</span> <span class="kn">import</span> <span class="n">util</span>
    <span class="kn">import</span> <span class="nn">numpy</span>

    <span class="n">bf1</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span>
        <span class="s">&quot; ( segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and nucleicbase ) or ( segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and nucleicbase ) &quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">seg1</span><span class="p">,</span> <span class="n">bp1</span><span class="p">,</span> <span class="n">seg2</span><span class="p">,</span> <span class="n">bp2</span><span class="p">))</span>
    <span class="n">bf4</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; ( segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and nucleicbase ) &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg3</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">bf2</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; ( segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and nucleicsugar ) &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg2</span><span class="p">,</span> <span class="n">bp2</span><span class="p">))</span>
    <span class="n">bf3</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot; ( segid </span><span class="si">%s</span><span class="s"> and resid </span><span class="si">%s</span><span class="s"> and nucleicsugar ) &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg3</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">bf1</span><span class="o">.</span><span class="n">centerOfMass</span><span class="p">(),</span> <span class="n">bf2</span><span class="o">.</span><span class="n">centerOfMass</span><span class="p">(),</span> <span class="n">bf3</span><span class="o">.</span><span class="n">centerOfMass</span><span class="p">(),</span> <span class="n">bf4</span><span class="o">.</span><span class="n">centerOfMass</span><span class="p">()]</span>
    <span class="n">pseudo</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">pseudo</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">pseudo</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pseudo</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pseudo</span> <span class="o">=</span> <span class="n">pseudo</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="k">return</span> <span class="n">pseudo</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">MDAnalysis 0.10.0-dev documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../MDAnalysis.html" >MDAnalysis</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Joshua Adelman,
    Christian Beckstein (logo), Alejandro Bernardin, Sébastien Buchoux,
    David Caplan, Matthieu Chavent, Xavier Deupi, Jan Domański, David L. Dotson
    Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar,
    Benjamin Hall, Joe Jordan, Jinju Lu, Robert McGibbon, Alex Nesterenko,
    Manuel Nuno Melo, Caio S. Souza, Danny Parton, Joshua L. Phillips, Tyler Reddy,
    Paul Rigor, Sean L. Seyler, Andy Somogyi, Lukas Stelzl, Zhuyi Xue,
    and Oliver Beckstein.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>