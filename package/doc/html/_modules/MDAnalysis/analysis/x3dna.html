

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MDAnalysis.analysis.x3dna &mdash; MDAnalysis 0.10.0-dev documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.10.0-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.10.0-dev documentation"
          href="../../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.10.0-dev documentation" href="../../../index.html" />
    <link rel="up" title="MDAnalysis" href="../../MDAnalysis.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">MDAnalysis 0.10.0-dev documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../MDAnalysis.html" accesskey="U">MDAnalysis</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for MDAnalysis.analysis.x3dna</h1><div class="highlight"><pre>
<span class="c"># -*- Mode: python; tab-width: 4; indent-tabs-mode:nil; coding:utf-8 -*-</span>
<span class="c"># vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4 fileencoding=utf-8</span>
<span class="c">#</span>
<span class="c"># MDAnalysis --- http://www.MDAnalysis.org</span>
<span class="c"># Copyright (c) 2006-2015 Naveen Michaud-Agrawal, Elizabeth J. Denning, Oliver Beckstein</span>
<span class="c"># and contributors (see AUTHORS for the full list)</span>
<span class="c">#</span>
<span class="c"># Released under the GNU Public Licence, v2 or any higher version</span>
<span class="c">#</span>
<span class="c"># Please cite your use of MDAnalysis in published work:</span>
<span class="c">#</span>
<span class="c"># N. Michaud-Agrawal, E. J. Denning, T. B. Woolf, and O. Beckstein.</span>
<span class="c"># MDAnalysis: A Toolkit for the Analysis of Molecular Dynamics Simulations.</span>
<span class="c"># J. Comput. Chem. 32 (2011), 2319--2327, doi:10.1002/jcc.21787</span>
<span class="c">#</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Generation and Analysis of X3DNA helicoidal parameter profiles --- :mod:`MDAnalysis.analysis.x3dna`</span>
<span class="sd">===================================================================================================</span>

<span class="sd">:Author: Elizabeth Denning</span>
<span class="sd">:Year: 2013-2014</span>
<span class="sd">:Copyright: GNU Public License v2</span>

<span class="sd">.. versionadded: 0.8</span>

<span class="sd">With the help of this module, X3DNA_ can be run on frames in a trajectory. Data</span>
<span class="sd">can be combined and analyzed. X3DNA_ [Lu2003]_ [Lu2008]_ must be installed</span>
<span class="sd">separately.</span>


<span class="sd">.. rubric:: References</span>

<span class="sd">.. [Lu2003] Xiang-Jun Lu &amp; Wilma K. Olson (2003).</span>
<span class="sd">            3DNA: a software package for the analysis, rebuilding and visualization</span>
<span class="sd">            for three-dimensional nucleic acid structure</span>
<span class="sd">            Nucleic Acids Res. 31(17), 5108-21.</span>

<span class="sd">.. [Lu2008] Xiang-Jun Lu &amp; Wilma K. Olson (2008).</span>
<span class="sd">            3DNA: a versatile, integrated software system for the analysis, rebuilding</span>
<span class="sd">            and visualization of three-dimensional nucleic-acid structures.</span>
<span class="sd">            Nat Protoc. 3(7), 1213-27.</span>

<span class="sd">.. _X3DNA: http://x3dna.org/</span>


<span class="sd">Examples</span>
<span class="sd">--------</span>

<span class="sd">Single structure</span>
<span class="sd">~~~~~~~~~~~~~~~~</span>

<span class="sd">B-DNA structure::</span>

<span class="sd">   from MDAnalysis.analysis.x3dna import X3DNA, X3DNAtraj</span>
<span class="sd">   from MDAnalysis.tests.datafiles import PDB_X3DNA</span>

<span class="sd">   # set path to your x3dna binary in bashrc file</span>
<span class="sd">   H = X3DNA(PDB_X3DNA, executable=&quot;x3dna_ensemble analyze -b 355d.bps -p pdbfile&quot;)</span>
<span class="sd">   H.run()</span>
<span class="sd">   H.collect()</span>
<span class="sd">   H.plot()</span>


<span class="sd">Trajectory</span>
<span class="sd">~~~~~~~~~~</span>

<span class="sd">Analyzing a trajectory::</span>

<span class="sd">  u = MDAnalysis.Universe(psf, trajectory)</span>
<span class="sd">  H = X3DNAtraj(u, ...)</span>
<span class="sd">  H.run()</span>
<span class="sd">  H.plot()</span>
<span class="sd">  H.save()</span>

<span class="sd">The profiles are available as the attribute :attr:`X3DNAtraj.profiles`</span>
<span class="sd">(``H.profiles`` in the example) and are indexed by frame number but</span>
<span class="sd">can also be indexed by an arbitrary order parameter as shown in the</span>
<span class="sd">next example.</span>



<span class="sd">Analysis</span>
<span class="sd">--------</span>

<span class="sd">.. autoclass:: X3DNA</span>
<span class="sd">   :members:</span>
<span class="sd">   :inherited-members:</span>

<span class="sd">   .. attribute:: profiles</span>

<span class="sd">      ``x3dna_ensemble analyze -b 355d.bps -p pdbfile attribute``:</span>
<span class="sd">      After running :meth:`X3DNA.collect`, this dict contains all the</span>
<span class="sd">      X3DNA profiles, indexed by the frame number. If only a single</span>
<span class="sd">      frame was analyzed then this will be ``X3DNA.profiles[0]``. Note</span>
<span class="sd">      that the order is random; one needs to sort the keys first.</span>

<span class="sd">.. autoclass:: X3DNAtraj</span>
<span class="sd">   :members:</span>
<span class="sd">   :inherited-members:</span>

<span class="sd">   .. attribute:: profiles</span>

<span class="sd">      After running :meth:`X3DNA.collect`, this dict contains all the</span>
<span class="sd">      X3DNA profiles, indexed by the frame number.</span>



<span class="sd">Utilities</span>
<span class="sd">---------</span>

<span class="sd">.. autoclass:: ApplicationError</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">with_statement</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">textwrap</span>

<span class="kn">from</span> <span class="nn">MDAnalysis</span> <span class="kn">import</span> <span class="n">ApplicationError</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.core.util</span> <span class="kn">import</span> <span class="n">which</span><span class="p">,</span> <span class="n">realpath</span><span class="p">,</span> <span class="n">asiterable</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;MDAnalysis.analysis.x3dna&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">mean_std_from_x3dnaPickle</span><span class="p">(</span><span class="n">profile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get mean and standard deviation of helicoidal parameters from a saved *profile*.</span>

<span class="sd">    The *profile* should have been saved with :meth:`BaseX3DNA.save`. Then</span>
<span class="sd">    load it with ::</span>

<span class="sd">      profile = cPickle.load(open(&quot;x3dna.pickle&quot;))</span>
<span class="sd">      h_mean, h_std = mean_std_from_x3dnaPickle(profile)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">profile</span><span class="o">.</span><span class="n">x3dna_param</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
        <span class="n">bp_shear</span><span class="p">,</span> <span class="n">bp_stretch</span><span class="p">,</span> <span class="n">bp_stagger</span><span class="p">,</span> <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_buckle</span><span class="p">,</span> <span class="n">bp_prop</span><span class="p">,</span> <span class="n">bp_open</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span>\
            <span class="n">bp_twist</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">profile</span><span class="p">)):</span>
            <span class="n">bp_shear</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shear</span><span class="p">)</span>
            <span class="n">bp_stretch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>
            <span class="n">bp_stagger</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stagger</span><span class="p">)</span>
            <span class="n">bp_buckle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Buckle</span><span class="p">)</span>
            <span class="n">bp_prop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Propeller</span><span class="p">)</span>
            <span class="n">bp_open</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Opening</span><span class="p">)</span>
            <span class="n">bp_rise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Rise</span><span class="p">)</span>
            <span class="n">bp_shift</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shift</span><span class="p">)</span>
            <span class="n">bp_slide</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Slide</span><span class="p">)</span>
            <span class="n">bp_tilt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Tilt</span><span class="p">)</span>
            <span class="n">bp_roll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Roll</span><span class="p">)</span>
            <span class="n">bp_twist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Twist</span><span class="p">)</span>
        <span class="n">bp_shear</span><span class="p">,</span> <span class="n">bp_stretch</span><span class="p">,</span> <span class="n">bp_stagger</span><span class="p">,</span> <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_buckle</span><span class="p">,</span> <span class="n">bp_prop</span><span class="p">,</span> <span class="n">bp_open</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span>\
            <span class="n">bp_twist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">),</span> \
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_open</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">)</span>
        <span class="n">na_avg</span><span class="p">,</span> <span class="n">na_std</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">na_avg</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_open</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])])</span>
            <span class="n">na_std</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_open</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span> <span class="n">bp_twist</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">profile</span><span class="p">)):</span>
            <span class="c">#print i</span>
            <span class="n">bp_rise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Rise</span><span class="p">)</span>
            <span class="n">bp_shift</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shift</span><span class="p">)</span>
            <span class="n">bp_slide</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Slide</span><span class="p">)</span>
            <span class="n">bp_tilt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Tilt</span><span class="p">)</span>
            <span class="n">bp_roll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Roll</span><span class="p">)</span>
            <span class="n">bp_twist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Twist</span><span class="p">)</span>
        <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span> <span class="n">bp_twist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">),</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_open</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">)</span>
        <span class="n">na_avg</span><span class="p">,</span> <span class="n">na_std</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">na_avg</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])])</span>
            <span class="n">na_std</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])])</span>

    <span class="n">na_avg</span><span class="p">,</span> <span class="n">na_std</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">na_avg</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">na_std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">na_avg</span><span class="p">,</span> <span class="n">na_std</span>


<span class="k">class</span> <span class="nc">BaseX3DNA</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Baseclass for X3DNA_ analysis, providing plotting and utility functions.</span>


<span class="sd">    .. _X3DNA: http://x3dna.org</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">&quot;x3dna.pickle&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save :attr:`profiles` as a Python pickle file *filename*.</span>

<span class="sd">        Load profiles dictionary with ::</span>

<span class="sd">           import cPickle</span>
<span class="sd">           profiles = cPickle.load(open(filename))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">cPickle</span>

        <span class="n">cPickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">),</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mean_std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;H.mean_std() returns the mean and standard deviation of base parameters (order of base parameters:Shear,</span>
<span class="sd">        Stretch,Stagger,Buckle,Propeller,Opening,Shift,Slide,Rise,Tilt,Roll,Twist) for each nucleic acid pair.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bp_shear</span><span class="p">,</span> <span class="n">bp_stretch</span><span class="p">,</span> <span class="n">bp_stagger</span><span class="p">,</span> <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_buckle</span><span class="p">,</span> <span class="n">bp_prop</span><span class="p">,</span> <span class="n">bp_open</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span>\
            <span class="n">bp_twist</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)):</span>
            <span class="n">bp_shear</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shear</span><span class="p">)</span>
            <span class="n">bp_stretch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>
            <span class="n">bp_stagger</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stagger</span><span class="p">)</span>
            <span class="n">bp_buckle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Buckle</span><span class="p">)</span>
            <span class="n">bp_prop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Propeller</span><span class="p">)</span>
            <span class="n">bp_open</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Opening</span><span class="p">)</span>
            <span class="n">bp_rise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Rise</span><span class="p">)</span>
            <span class="n">bp_shift</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shift</span><span class="p">)</span>
            <span class="n">bp_slide</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Slide</span><span class="p">)</span>
            <span class="n">bp_tilt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Tilt</span><span class="p">)</span>
            <span class="n">bp_roll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Roll</span><span class="p">)</span>
            <span class="n">bp_twist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Twist</span><span class="p">)</span>
        <span class="n">bp_shear</span><span class="p">,</span> <span class="n">bp_stretch</span><span class="p">,</span> <span class="n">bp_stagger</span><span class="p">,</span> <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_buckle</span><span class="p">,</span> <span class="n">bp_prop</span><span class="p">,</span> <span class="n">bp_open</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span>\
            <span class="n">bp_twist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_open</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">)</span>
        <span class="n">na_avg</span><span class="p">,</span> <span class="n">na_std</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">na_avg</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_open</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])])</span>
            <span class="n">na_std</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_open</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])])</span>
        <span class="n">na_avg</span><span class="p">,</span> <span class="n">na_std</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">na_avg</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">na_std</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">na_avg</span><span class="p">,</span> <span class="n">na_std</span>

    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;H.mean() returns the mean value for the base parameters (order of base parameters:Shear,Stretch,Stagger,</span>
<span class="sd">        Buckle,Propeller,Opening,Shift,Slide,Rise,Tilt,Roll,Twist) for each nucleic acid pair.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bp_shear</span><span class="p">,</span> <span class="n">bp_stretch</span><span class="p">,</span> <span class="n">bp_stagger</span><span class="p">,</span> <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_buckle</span><span class="p">,</span> <span class="n">bp_prop</span><span class="p">,</span> <span class="n">bp_open</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span>\
            <span class="n">bp_twist</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)):</span>
            <span class="n">bp_shear</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shear</span><span class="p">)</span>
            <span class="n">bp_stretch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>
            <span class="n">bp_stagger</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stagger</span><span class="p">)</span>
            <span class="n">bp_buckle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Buckle</span><span class="p">)</span>
            <span class="n">bp_prop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Propeller</span><span class="p">)</span>
            <span class="n">bp_open</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Opening</span><span class="p">)</span>
            <span class="n">bp_rise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Rise</span><span class="p">)</span>
            <span class="n">bp_shift</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shift</span><span class="p">)</span>
            <span class="n">bp_slide</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Slide</span><span class="p">)</span>
            <span class="n">bp_tilt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Tilt</span><span class="p">)</span>
            <span class="n">bp_roll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Roll</span><span class="p">)</span>
            <span class="n">bp_twist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Twist</span><span class="p">)</span>
        <span class="n">bp_shear</span><span class="p">,</span> <span class="n">bp_stretch</span><span class="p">,</span> <span class="n">bp_stagger</span><span class="p">,</span> <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_buckle</span><span class="p">,</span> <span class="n">bp_prop</span><span class="p">,</span> <span class="n">bp_open</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span>\
            <span class="n">bp_twist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_open</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">)</span>

        <span class="n">na_avg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">na_avg</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">[:</span><span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_open</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])])</span>
        <span class="n">na_avg</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">na_avg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">na_avg</span>

    <span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;H.std() returns the standard deviation of base parameters (order of base parameters:Shear,Stretch,Stagger,</span>
<span class="sd">        Buckle,Propeller,Opening,Shift,Slide,Rise,Tilt,Roll,Twist) for each nucleic acid pair.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bp_shear</span><span class="p">,</span> <span class="n">bp_stretch</span><span class="p">,</span> <span class="n">bp_stagger</span><span class="p">,</span> <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_buckle</span><span class="p">,</span> <span class="n">bp_prop</span><span class="p">,</span> <span class="n">bp_open</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span>\
            <span class="n">bp_twist</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)):</span>
            <span class="n">bp_shear</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shear</span><span class="p">)</span>
            <span class="n">bp_stretch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>
            <span class="n">bp_stagger</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stagger</span><span class="p">)</span>
            <span class="n">bp_buckle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Buckle</span><span class="p">)</span>
            <span class="n">bp_prop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Propeller</span><span class="p">)</span>
            <span class="n">bp_open</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Opening</span><span class="p">)</span>
            <span class="n">bp_rise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Rise</span><span class="p">)</span>
            <span class="n">bp_shift</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Shift</span><span class="p">)</span>
            <span class="n">bp_slide</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Slide</span><span class="p">)</span>
            <span class="n">bp_tilt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Tilt</span><span class="p">)</span>
            <span class="n">bp_roll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Roll</span><span class="p">)</span>
            <span class="n">bp_twist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Twist</span><span class="p">)</span>
        <span class="n">bp_shear</span><span class="p">,</span> <span class="n">bp_stretch</span><span class="p">,</span> <span class="n">bp_stagger</span><span class="p">,</span> <span class="n">bp_rise</span><span class="p">,</span> <span class="n">bp_shift</span><span class="p">,</span> <span class="n">bp_slide</span><span class="p">,</span> <span class="n">bp_buckle</span><span class="p">,</span> <span class="n">bp_prop</span><span class="p">,</span> <span class="n">bp_open</span><span class="p">,</span> <span class="n">bp_tilt</span><span class="p">,</span> <span class="n">bp_roll</span><span class="p">,</span>\
            <span class="n">bp_twist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">),</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_open</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">)</span>

        <span class="n">na_std</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">na_std</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_shear</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_stretch</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_stagger</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_buckle</span><span class="p">[:</span><span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_prop</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_open</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_shift</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_slide</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_rise</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_tilt</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_roll</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]),</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bp_twist</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])])</span>
        <span class="n">na_std</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">na_std</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">na_std</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot base parameter profiles  in a 1D graph</span>
<span class="sd">           (plotting of the mean and standard deviation parameter value for each individual base pair).</span>

<span class="sd">        :Keywords:</span>
<span class="sd">           *Not available at this time*</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span>

        <span class="n">na_avg</span><span class="p">,</span> <span class="n">na_std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_std</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">na_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;ax&#39;</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">))</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">na_avg</span><span class="p">[:,</span> <span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">na_avg</span><span class="p">[:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">na_std</span><span class="p">[:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s">&#39;-o&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">na_avg</span><span class="p">[:,</span> <span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r&quot;Nucleic Acid Number&quot;</span><span class="p">)</span>
            <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;Shear&quot;</span><span class="p">,</span> <span class="s">&quot;Stretch&quot;</span><span class="p">,</span> <span class="s">&quot;Stagger&quot;</span><span class="p">,</span> <span class="s">&quot;Rise&quot;</span><span class="p">,</span> <span class="s">&quot;Shift&quot;</span><span class="p">,</span> <span class="s">&quot;Slide&quot;</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> ($\AA$)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">param</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> (deg)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">param</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">param</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">sorted_profiles_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an iterator over profiles sorted by frame/order parameter *q*.</span>

<span class="sd">        The iterator produces tuples ``(q, profile)``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">):</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">q</span><span class="p">])</span>

    <span class="n">__iter__</span> <span class="o">=</span> <span class="n">sorted_profiles_iter</span>


<div class="viewcode-block" id="X3DNA"><a class="viewcode-back" href="../../../documentation_pages/analysis/x3dna.html#MDAnalysis.analysis.x3dna.X3DNA">[docs]</a><span class="k">class</span> <span class="nc">X3DNA</span><span class="p">(</span><span class="n">BaseX3DNA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run X3DNA_ on a single frame or a DCD trajectory.</span>

<span class="sd">    Only a subset of all X3DNA control parameters is supported and can be set</span>
<span class="sd">    with keyword arguments. For further details on X3DNA_ see the `X3DNA docs`_.</span>

<span class="sd">    Running X3DNA with the :class:`X3DNA` class is a 3-step process:</span>

<span class="sd">     1. set up the class with all desired parameters</span>
<span class="sd">     2. run X3DNA with :meth:`X3DNA.run`</span>
<span class="sd">     3. collect the data from the output file with :meth:`X3DNA.collect`</span>

<span class="sd">    The class also provides some simple plotting functions of the collected</span>
<span class="sd">    data such as :meth:`X3DNA.plot` or :meth:`X3DNA.plot3D`.</span>

<span class="sd">    .. versionadded:: 0.8</span>

<span class="sd">    .. _`X3DNA docs`: http://forum.x3dna.org/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set up parameters to run X3DNA_ on PDB *filename*.</span>

<span class="sd">        :Arguments:</span>

<span class="sd">          *filename*</span>

<span class="sd">               The *filename* is used as input for X3DNA in the &quot;xdna_ensemble&quot;</span>
<span class="sd">               command.  It specifies the name of a PDB coordinate file</span>
<span class="sd">               to be used. This must be in Brookhaven protein databank format</span>
<span class="sd">               or something closely approximating this. Both ATOM and HETATM</span>
<span class="sd">               records are read. Note that if water molecules or ions are</span>
<span class="sd">               present in the channel these can be ignored on read by the use</span>
<span class="sd">               of the *ignore_residues* keyword.</span>

<span class="sd">        :Keywords:</span>

<span class="sd">          *executable*</span>

<span class="sd">               Path to the :program:`xdna_ensemble` executable directories</span>
<span class="sd">               (e.g. ``/opt/x3dna/2.1 and /opt/x3dna/2.1/bin``) must be set</span>
<span class="sd">               and then added to export in bashrc file. See X3DNA</span>
<span class="sd">               documentation for set-up instructions.</span>

<span class="sd">          *x3dna_param*</span>

<span class="sd">               Determines whether base step or base pair parameters will be</span>
<span class="sd">               calculated. If True then stacked base step parameters will be</span>
<span class="sd">               analyzed [Default is True].  If False then stacked base pair</span>
<span class="sd">               parameters will be analyzed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># list of temporary files, to be cleaned up on __del__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tempfiles</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">&quot;auxiliary.par&quot;</span><span class="p">,</span> <span class="s">&quot;bestpairs.pdb&quot;</span><span class="p">,</span> <span class="s">&quot;bp_order.dat&quot;</span><span class="p">,</span> <span class="s">&quot;bp_helical.par&quot;</span><span class="p">,</span> <span class="s">&quot;cf_7methods.par&quot;</span><span class="p">,</span>
            <span class="s">&quot;col_chains.scr&quot;</span><span class="p">,</span> <span class="s">&quot;col_helices.scr&quot;</span><span class="p">,</span> <span class="s">&quot;hel_regions.pdb&quot;</span><span class="p">,</span> <span class="s">&quot;ref_frames.dat&quot;</span><span class="p">,</span> <span class="s">&quot;hstacking.pdb&quot;</span><span class="p">,</span> <span class="s">&quot;stacking.pdb&quot;</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tempdirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Setting up X3DNA analysis for </span><span class="si">%(filename)r</span><span class="s">&quot;</span><span class="p">,</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="c"># guess executables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exe</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">x3dna_exe_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;executable&#39;</span><span class="p">,</span> <span class="s">&#39;xdna_ensemble&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_param</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;x3dna_param&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exe</span><span class="p">[</span><span class="s">&#39;xdna_ensemble&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">which</span><span class="p">(</span><span class="n">x3dna_exe_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exe</span><span class="p">[</span><span class="s">&#39;xdna_ensemble&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="s">&quot;X3DNA binary </span><span class="si">%(x3dna_exe_name)r</span><span class="s"> not found.&quot;</span> <span class="o">%</span> <span class="nb">vars</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(x3dna_exe_name)r</span><span class="s"> must be on the PATH or provided as keyword argument &#39;executable&#39;.&quot;</span><span class="p">,</span>
                         <span class="nb">vars</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span> <span class="n">errmsg</span><span class="p">)</span>
        <span class="n">x3dnapath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exe</span><span class="p">[</span><span class="s">&#39;xdna_ensemble&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;logfile&quot;</span><span class="p">,</span> <span class="s">&quot;bp_step.par&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_param</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s">&quot;&quot;&quot;x3dna_ensemble analyze -b 355d.bps --one </span><span class="si">%(filename)r</span><span class="s"> &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s">&quot;&quot;&quot;find_pair -s </span><span class="si">%(filename)r</span><span class="s"> stdout |analyze stdin &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="c"># sanity checks</span>
        <span class="k">for</span> <span class="n">program</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exe</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">which</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Executable </span><span class="si">%(program)r</span><span class="s"> not found, should have been </span><span class="si">%(path)r</span><span class="s">.&quot;</span><span class="p">,</span>
                             <span class="nb">vars</span><span class="p">())</span>
        <span class="c"># results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="X3DNA.run"><a class="viewcode-back" href="../../../documentation_pages/analysis/x3dna.html#MDAnalysis.analysis.x3dna.X3DNA.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run X3DNA on the input file.&quot;&quot;&quot;</span>
        <span class="n">inpname</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;inpfile&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">outname</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;outfile&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">)</span>

        <span class="n">x3dnaargs</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">x3dnaargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">x3dna_param</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;x3dna_param&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_param</span><span class="p">)</span>

        <span class="n">inp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span> <span class="o">%</span> <span class="n">x3dnaargs</span>
        <span class="k">if</span> <span class="n">inpname</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">inpname</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Wrote X3DNA input file </span><span class="si">%r</span><span class="s"> for inspection&quot;</span><span class="p">,</span> <span class="n">inpname</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Starting X3DNA on </span><span class="si">%(filename)r</span><span class="s"> (trajectory: </span><span class="si">%(dcd)r</span><span class="s">)&quot;</span><span class="p">,</span> <span class="n">x3dnaargs</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exe</span><span class="p">[</span><span class="s">&#39;xdna_ensemble&#39;</span><span class="p">])</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outname</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">x3dna</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="n">inp</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outname</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output</span><span class="p">:</span>
            <span class="c"># X3DNA is not very good at setting returncodes so check ourselves</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s">&#39;*** ERROR ***&#39;</span><span class="p">,</span> <span class="s">&#39;ERROR&#39;</span><span class="p">)):</span>
                    <span class="n">x3dna</span><span class="o">.</span><span class="n">returncode</span> <span class="o">=</span> <span class="mi">255</span>
                    <span class="k">break</span>
        <span class="k">if</span> <span class="n">x3dna</span><span class="o">.</span><span class="n">bit_length</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;X3DNA Failure (</span><span class="si">%d</span><span class="s">). Check output </span><span class="si">%r</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">x3dna</span><span class="o">.</span><span class="n">bit_length</span><span class="p">,</span> <span class="n">outname</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;X3DNA finished: output file </span><span class="si">%(outname)r</span><span class="s">&quot;</span><span class="p">,</span> <span class="nb">vars</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="X3DNA.collect"><a class="viewcode-back" href="../../../documentation_pages/analysis/x3dna.html#MDAnalysis.analysis.x3dna.X3DNA.collect">[docs]</a>    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse the output from a X3DNA run into numpy recarrays.</span>

<span class="sd">        Can deal with outputs containing multiple frames. Output format:</span>

<span class="sd">        The method saves the result as :attr:`X3DNA.profiles`, a dictionary</span>
<span class="sd">        indexed by the frame number. Each entry is a</span>
<span class="sd">        :class:`numpy.recarray`.</span>

<span class="sd">        If the keyword *outdir* is supplied (e.g. &quot;.&quot;) then each profile is</span>
<span class="sd">        saved to a gzipped data file.</span>

<span class="sd">        :Keywords:</span>
<span class="sd">           *run*</span>
<span class="sd">              identifier, free form [1]</span>
<span class="sd">           *outdir*</span>
<span class="sd">              save output data under *outdir*/*run* if set to any other</span>
<span class="sd">              value but ``None`` [``None``]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#        Shear    Stretch   Stagger   Buckle   Prop-Tw   Opening     Shift     Slide     Rise      Tilt</span>
        <span class="c"># Roll      Twist</span>
        <span class="c">#0123456789.0123456789.0123456789.0123456789.0123456789.0123456789.</span>
        <span class="c">#            11          22          33          44</span>
        <span class="c">#123456789.123456789.123456789.123456789.123456789.123456789.123456789.</span>
        <span class="c">#1           13</span>
        <span class="c">#T-A     -0.033    -0.176     0.158   -12.177    -8.979     1.440     0.000     0.000     0.000     0.000</span>
        <span class="c">#  0.000     0.000</span>
        <span class="c">#C-G     -0.529     0.122    -0.002    -7.983   -10.083    -0.091    -0.911     1.375     3.213    -0.766</span>
        <span class="c"># -4.065    41.492</span>
        <span class="c"># only parse bp_step.par</span>
        <span class="n">x3dna_output</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;x3dnaout&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">)</span>

        <span class="n">run</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;run&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c"># id number</span>
        <span class="n">outdir</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;outdir&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">curdir</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Collecting X3DNA profiles for run with id </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">run</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c"># length of trajectory --- is this really needed?? No... just for info</span>
        <span class="k">if</span> <span class="s">&#39;*&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">glob</span>

            <span class="n">filenames</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Glob pattern </span><span class="si">%r</span><span class="s"> did not find any files.&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Glob pattern </span><span class="si">%r</span><span class="s"> did not find any files.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Found </span><span class="si">%d</span><span class="s"> input files based on glob pattern </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

        <span class="c"># one recarray for each frame, indexed by frame number</span>
        <span class="c"># TODO: use ordered dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Run </span><span class="si">%s</span><span class="s">: Reading </span><span class="si">%d</span><span class="s"> X3DNA profiles from </span><span class="si">%r</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">x3dna_output</span><span class="p">)</span>
        <span class="n">x3dna_profile_no</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">x3dna_output</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">x3dna</span><span class="p">:</span>
            <span class="n">read_data</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">x3dna</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>  <span class="c"># preserve columns (FORTRAN output...)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_param</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;#        Shear&quot;</span><span class="p">):</span>
                        <span class="n">read_data</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Started reading data&quot;</span><span class="p">)</span>
                        <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="n">x3dna_profile_no</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># useless int value code based off hole plugin</span>
                        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">read_data</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">Sequence</span><span class="p">,</span> <span class="n">Shear</span><span class="p">,</span> <span class="n">Stretch</span><span class="p">,</span> <span class="n">Stagger</span><span class="p">,</span> <span class="n">Buckle</span><span class="p">,</span> <span class="n">Propeller</span><span class="p">,</span> <span class="n">Opening</span><span class="p">,</span> <span class="n">Shift</span><span class="p">,</span> <span class="n">Slide</span><span class="p">,</span> <span class="n">Rise</span><span class="p">,</span> \
                                    <span class="n">Tilt</span><span class="p">,</span> <span class="n">Roll</span><span class="p">,</span> <span class="n">Twist</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s">&quot;Run </span><span class="si">%d</span><span class="s">: Problem parsing line </span><span class="si">%r</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s">&quot;Check input file </span><span class="si">%r</span><span class="s">.&quot;</span><span class="p">,</span> <span class="n">x3dna_output</span><span class="p">)</span>
                                <span class="k">raise</span>
                            <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">Shear</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Stretch</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Stagger</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Buckle</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Propeller</span><span class="p">),</span>
                                    <span class="nb">float</span><span class="p">(</span><span class="n">Opening</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Shift</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Slide</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Rise</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Tilt</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Roll</span><span class="p">),</span>
                                    <span class="nb">float</span><span class="p">(</span><span class="n">Twist</span><span class="p">)])</span>
                            <span class="k">continue</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c"># end of records (empty line)</span>
                            <span class="n">read_data</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;#      Shift&quot;</span><span class="p">):</span>
                        <span class="n">read_data</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Started reading data&quot;</span><span class="p">)</span>
                        <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="n">x3dna_profile_no</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># useless int value code based off hole plugin</span>
                        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">read_data</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">Sequence</span><span class="p">,</span> <span class="n">Shift</span><span class="p">,</span> <span class="n">Slide</span><span class="p">,</span> <span class="n">Rise</span><span class="p">,</span> <span class="n">Tilt</span><span class="p">,</span> <span class="n">Roll</span><span class="p">,</span> <span class="n">Twist</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s">&quot;Run </span><span class="si">%d</span><span class="s">: Problem parsing line </span><span class="si">%r</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s">&quot;Check input file </span><span class="si">%r</span><span class="s">.&quot;</span><span class="p">,</span> <span class="n">x3dna_output</span><span class="p">)</span>
                                <span class="k">raise</span>
                            <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">Shift</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Slide</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Rise</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Tilt</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Roll</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Twist</span><span class="p">)])</span>
                            <span class="k">continue</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c"># end of records (empty line)</span>
                            <span class="n">read_data</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_param</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">frame_x3dna_output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rec</span><span class="o">.</span><span class="n">fromrecords</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="s">&quot;f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8&quot;</span><span class="p">,</span>
                                                           <span class="n">names</span><span class="o">=</span><span class="s">&quot;Shear,Stretch,Stagger,Buckle,Propeller,Opening,&quot;</span>
                                                                 <span class="s">&quot;Shift,Slide,Rise,Tilt,Roll,Twist&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">frame_x3dna_output</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rec</span><span class="o">.</span><span class="n">fromrecords</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="s">&quot;f8,f8,f8,f8,f8,f8&quot;</span><span class="p">,</span>
                                                           <span class="n">names</span><span class="o">=</span><span class="s">&quot;Shift,Slide,Rise,Tilt,Roll,Twist&quot;</span><span class="p">)</span>
            <span class="c"># store the profile</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">x3dna_profile_no</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame_x3dna_output</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Collected X3DNA profile for frame </span><span class="si">%d</span><span class="s"> (</span><span class="si">%d</span><span class="s"> datapoints)&quot;</span><span class="p">,</span>
                         <span class="n">x3dna_profile_no</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame_x3dna_output</span><span class="p">))</span>
            <span class="c"># save a profile for each frame (for debugging and scripted processing)</span>
            <span class="c"># a tmp folder for each trajectory</span>
            <span class="k">if</span> <span class="n">outdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">rundir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span> <span class="s">&quot;run_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">run</span><span class="p">))</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&quot;rm -f tmp*.out&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">rundir</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">rundir</span><span class="p">)</span>
                <span class="n">frame_x3dna_txt</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rundir</span><span class="p">,</span> <span class="s">&quot;bp_step_</span><span class="si">%s</span><span class="s">_</span><span class="si">%04d</span><span class="s">.dat.gz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="n">x3dna_profile_no</span><span class="p">))</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">frame_x3dna_txt</span><span class="p">,</span> <span class="n">frame_x3dna_output</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Finished with frame </span><span class="si">%d</span><span class="s">, saved as </span><span class="si">%r</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">x3dna_profile_no</span><span class="p">,</span> <span class="n">frame_x3dna_txt</span><span class="p">)</span>
                <span class="c"># if we get here then we haven&#39;t found anything interesting</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)</span> <span class="o">==</span> <span class="n">length</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Collected X3DNA profiles for </span><span class="si">%d</span><span class="s"> frames&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Missing data: Found </span><span class="si">%d</span><span class="s"> X3DNA profiles from </span><span class="si">%d</span><span class="s"> frames.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">),</span> <span class="n">length</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempfiles</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempdirs</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="X3DNAtraj"><a class="viewcode-back" href="../../../documentation_pages/analysis/x3dna.html#MDAnalysis.analysis.x3dna.X3DNAtraj">[docs]</a><span class="k">class</span> <span class="nc">X3DNAtraj</span><span class="p">(</span><span class="n">BaseX3DNA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Analyze all frames in a trajectory.</span>

<span class="sd">    The :class:`X3DNA` class provides a direct interface to X3DNA. X3DNA itself</span>
<span class="sd">    has limited support for analysing trajectories but cannot deal with all the</span>
<span class="sd">    trajectory formats understood by MDAnalysis. This class can take any</span>
<span class="sd">    universe and feed it to X3DNA. By default it sequentially creates a PDB for</span>
<span class="sd">    each frame and runs X3DNA on the frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">universe</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set up the class.</span>

<span class="sd">        :Arguments:</span>

<span class="sd">          *universe*</span>
<span class="sd">               The input trajectory as part of a</span>
<span class="sd">               :class:`~MDAnalysis.core.AtomGroup.Universe`. trajectory is</span>
<span class="sd">               converted to a sequence of PDB files and X3DNA is run on each</span>
<span class="sd">               individual file. (Use the *start*, *stop*, and *step* keywords</span>
<span class="sd">               to slice the trajectory.)</span>

<span class="sd">          *start*, *stop*, *step*</span>
<span class="sd">               frame indices to slice the trajectory as</span>
<span class="sd">               ``universe.trajectory[start, stop, step]``</span>

<span class="sd">          *x3dna_param*</span>
<span class="sd">               indicates whether stacked bases or stacked base-pairs will be</span>
<span class="sd">               analyzed. True is bases or False is stacked base-pairs [Default</span>
<span class="sd">               is True].</span>

<span class="sd">          *kwargs*</span>
<span class="sd">               All other keywords are passed on to :class:`X3DNA` (see there for description).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">universe</span> <span class="o">=</span> <span class="n">universe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;selection&quot;</span><span class="p">,</span> <span class="s">&quot;nucleic&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_param</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;x3dna_param&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;stop&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;step&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="c"># processing</span>

<div class="viewcode-block" id="X3DNAtraj.run"><a class="viewcode-back" href="../../../documentation_pages/analysis/x3dna.html#MDAnalysis.analysis.x3dna.X3DNAtraj.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run X3DNA on the whole trajectory and collect profiles.</span>

<span class="sd">        Keyword arguments *start*, *stop*, and *step* can be used to only</span>
<span class="sd">        analyse part of the trajectory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;stop&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;step&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
        <span class="n">x3dna_param</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;x3dna_param&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_param</span><span class="p">)</span>
        <span class="n">x3dna_kw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">x3dna_kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">profiles</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">nucleic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">universe</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">:</span><span class="n">step</span><span class="p">]:</span>
            <span class="k">print</span> <span class="n">ts</span><span class="o">.</span><span class="n">frame</span>
            <span class="k">print</span> <span class="n">nucleic</span><span class="o">.</span><span class="n">atoms</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;X3DNA analysis frame </span><span class="si">%4d</span><span class="s"> &quot;</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
            <span class="n">fd</span><span class="p">,</span> <span class="n">pdbfile</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s">&quot;.pdb&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
            <span class="n">nucleic</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&quot;find_pair </span><span class="si">%s</span><span class="s"> 355d.bps&quot;</span> <span class="o">%</span> <span class="n">pdbfile</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nucleic</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">)</span>
                <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                if int(ts.frame) in [int(start+1), 1]:</span>
<span class="sd">                    #print start</span>
<span class="sd">                    os.system(&quot;find_pair %s 355d.bps&quot; %(pdbfile))</span>
<span class="sd">                    #print &quot;complete&quot;</span>
<span class="sd">                &#39;&#39;&#39;</span>
                <span class="n">x3dna_profiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_x3dna</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">,</span> <span class="o">**</span><span class="n">x3dna_kw</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x3dna_profiles</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">err_msg</span> <span class="o">=</span> <span class="s">&quot;Got {0} profiles ({1}) --- should be 1 (time step {2})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">x3dna_profiles</span><span class="p">),</span> <span class="n">x3dna_profiles</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">ts</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="n">profiles</span><span class="p">[</span><span class="n">ts</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span> <span class="o">=</span> <span class="n">x3dna_profiles</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">profiles</span>
</div>
<div class="viewcode-block" id="X3DNAtraj.run_x3dna"><a class="viewcode-back" href="../../../documentation_pages/analysis/x3dna.html#MDAnalysis.analysis.x3dna.X3DNAtraj.run_x3dna">[docs]</a>    <span class="k">def</span> <span class="nf">run_x3dna</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbfile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run X3DNA on a single PDB file *pdbfile*.&quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;x3dna_param&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x3dna_param</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">X3DNA</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">H</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">H</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">H</span><span class="o">.</span><span class="n">profiles</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">MDAnalysis 0.10.0-dev documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../MDAnalysis.html" >MDAnalysis</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Joshua Adelman,
    Christian Beckstein (logo), Alejandro Bernardin, Sébastien Buchoux,
    David Caplan, Matthieu Chavent, Xavier Deupi, Jan Domański, David L. Dotson
    Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar,
    Benjamin Hall, Joe Jordan, Jinju Lu, Robert McGibbon, Alex Nesterenko,
    Manuel Nuno Melo, Caio S. Souza, Danny Parton, Joshua L. Phillips, Tyler Reddy,
    Paul Rigor, Sean L. Seyler, Andy Somogyi, Lukas Stelzl, Zhuyi Xue,
    and Oliver Beckstein.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>